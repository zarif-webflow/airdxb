import{g as n,a as c,s as m}from"./chunks/util.js";const h=a=>{m(a,{display:"none",width:"1px",height:"1px",padding:"0px",margin:"-1px",overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)","white-space":"nowrap","overflow-wrap":"normal"})},u=new Set;class l{constructor(t){Object.defineProperty(this,"rootElement",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trigger",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"viewport",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"optionItems",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"elementIds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.rootElement=t,this.trigger=n("[data-st-trigger]",this.rootElement),this.content=n("[data-st-content]",this.rootElement),this.viewport=n("[data-st-viewport]",this.rootElement),this.optionItems=this.getOptionItems(),this.elementIds=this.generateElementIds(),this.setupNativeSelect(),this.initialAriaSetup()}generateId(){for(;;){const t=Math.random().toString(36).substring(2,8);if(!u.has(t))return t}}generateElementIds(){const t=`st::${this.generateId()}`;let e=this.rootElement.id;e===""&&(e=t,this.rootElement.id=e);const i={id:t,content:`${t}::content`,trigger:`${t}::trigger`,viewport:`${t}::viewport`,rootElement:e};return this.content.id=i.content,this.trigger.id=i.trigger,this.viewport.id=i.viewport,i}getOptionItems(){const t={},e=c("[data-st-option]",this.rootElement);for(const i of e){const r=i.getAttribute("value")??i.textContent?.trim();if(r===void 0)throw new Error("Option element must have a value or a text content!");t[r]={element:i,isDefault:i.hasAttribute("selected")}}return t}setupNativeSelect(){let t=!1;const e=document.createElement("select"),i=this.rootElement.getAttribute("name");i&&(e.name=i),e.ariaHidden="true",e.tabIndex=-1;const r=document.createDocumentFragment();for(const s of Object.keys(this.optionItems)){const d=this.optionItems[s]?.isDefault,o=document.createElement("option");o.value=s,o.textContent=s,d&&!t&&(o.setAttribute("selected",""),t=!0),r.appendChild(o)}return e.appendChild(r),h(e),this.rootElement.appendChild(e),e}initialAriaSetup(){this.trigger.setAttribute("type","button"),this.trigger.tagName!=="BUTTON"&&(this.trigger.role="button"),this.trigger.ariaHasPopup="listbox",this.trigger.ariaExpanded="false",this.trigger.setAttribute("aria-controls",this.elementIds.content),this.content.role="listbox",this.content.tabIndex=0,this.content.setAttribute("aria-labelledby",this.elementIds.trigger),this.content.ariaOrientation="vertical",this.viewport.role="presentation";for(const t of Object.values(this.optionItems))t.element.role="option",t.element.tabIndex=-1,t.element.ariaSelected=t.isDefault?"true":"false",t.element.dataset.selected=t.isDefault?"true":"false",t.element.querySelectorAll("svg").forEach(e=>{e.ariaHidden="true"})}}new l(n("[data-st-root]")),new l(n("[data-st-root2]"));
